!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).glowworm={})}(this,function(t){"use strict";var c=function(){return(c=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function s(t,e,r){if(r||2===arguments.length)for(var o,n=0,a=e.length;n<a;n++)!o&&n in e||((o=o||Array.prototype.slice.call(e,0,n))[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))}var e="object"==typeof global&&global&&global.Object===Object&&global,r="object"==typeof self&&self&&self.Object===Object&&self,r=e||r||Function("return this")(),o=r.Symbol,n=Object.prototype,B=n.hasOwnProperty,I=n.toString,i=o?o.toStringTag:void 0;var U=Object.prototype.toString;var R="[object Null]",T="[object Undefined]",q=o?o.toStringTag:void 0;function a(t){if(null==t)return void 0===t?T:R;if(q&&q in Object(t)){var e=t,r=B.call(e,i),o=e[i];try{var n=!(e[i]=void 0)}catch(t){}var a=I.call(e);return n&&(r?e[i]=o:delete e[i]),a}return U.call(t)}function u(t){return null!=t&&"object"==typeof t}var S=Array.isArray;function x(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var G="[object AsyncFunction]",$="[object Function]",N="[object GeneratorFunction]",V="[object Proxy]";function W(t){if(x(t))return(t=a(t))==$||t==N||t==G||t==V}var n=r["__core-js_shared__"],H=(n=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";var J=Function.prototype.toString;function l(t){if(null!=t){try{return J.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var K=/^\[object .+?Constructor\]$/,n=Function.prototype,p=Object.prototype,n=n.toString,p=p.hasOwnProperty,Q=RegExp("^"+n.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function X(t){var e;return x(t)&&(e=t,!(H&&H in e))&&(W(t)?Q:K).test(l(t))}function f(t,e){e=e;t=null==(t=t)?void 0:t[e];return X(t)?t:void 0}var n=f(r,"WeakMap"),Y=Object.create;function y(){}var Z=function(t){if(!x(t))return{};if(Y)return Y(t);y.prototype=t;t=new y;return y.prototype=void 0,t};var tt=function(){try{var t=f(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var et=/^(?:0|[1-9]\d*)$/;function rt(t,e,r){"__proto__"==e&&tt?tt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function ot(t,e){return t===e||t!=t&&e!=e}var nt=Object.prototype.hasOwnProperty;function at(t,e,r){var o=t[e];nt.call(t,e)&&ot(o,r)&&(void 0!==r||e in t)||rt(t,e,r)}function z(t,e,r,o){for(var n=!r,a=(r=r||{},-1),c=e.length;++a<c;){var i=e[a],u=o?o(r[i],t[i],i,r,t):void 0;(n?rt:at)(r,i,u=void 0===u?t[i]:u)}return r}var ct=9007199254740991;function it(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=ct}function ut(t){return null!=t&&it(t.length)&&!W(t)}var lt=Object.prototype;function C(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||lt)}function st(t){return u(t)&&"[object Arguments]"==a(t)}var p=Object.prototype,pt=p.hasOwnProperty,ft=p.propertyIsEnumerable,yt=st(function(){return arguments}())?st:function(t){return u(t)&&pt.call(t,"callee")&&!ft.call(t,"callee")};var p="object"==typeof t&&t&&!t.nodeType&&t,b=p&&"object"==typeof module&&module&&!module.nodeType&&module,b=b&&b.exports===p?r.Buffer:void 0,bt=(b?b.isBuffer:void 0)||function(){return!1},h={};function d(e){return function(t){return e(t)}}h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h["[object Arguments]"]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h["[object Function]"]=h["[object Map]"]=h["[object Number]"]=h["[object Object]"]=h["[object RegExp]"]=h["[object Set]"]=h["[object String]"]=h["[object WeakMap]"]=!1;var p="object"==typeof t&&t&&!t.nodeType&&t,v=p&&"object"==typeof module&&module&&!module.nodeType&&module,ht=v&&v.exports===p&&e.process,b=function(){try{var t=v&&v.require&&v.require("util").types;return t?t:ht&&ht.binding&&ht.binding("util")}catch(t){}}(),p=b&&b.isTypedArray,dt=p?d(p):function(t){return u(t)&&it(t.length)&&!!h[a(t)]},vt=Object.prototype.hasOwnProperty;function jt(t,e){var r,o,n,a,c=S(t),i=!c&&yt(t),u=!c&&!i&&bt(t),l=!c&&!i&&!u&&dt(t),s=c||i||u||l,p=s?function(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}(t.length,String):[],f=p.length;for(r in t)!e&&!vt.call(t,r)||s&&("length"==r||u&&("offset"==r||"parent"==r)||l&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||(a=void 0,a=typeof(o=r),(n=null==(n=f)?9007199254740991:n)&&("number"==a||"symbol"!=a&&et.test(o))&&-1<o&&o%1==0&&o<n))||p.push(r);return p}function _t(e,r){return function(t){return e(r(t))}}var gt=_t(Object.keys,Object),mt=Object.prototype.hasOwnProperty;function wt(t){return(ut(t)?jt:function(t){if(!C(t))return gt(t);var e,r=[];for(e in Object(t))mt.call(t,e)&&"constructor"!=e&&r.push(e);return r})(t)}var At=Object.prototype.hasOwnProperty;function Ot(t){if(!x(t)){var e=t,r=[];if(null!=e)for(var o in Object(e))r.push(o);return r}var n,a=C(t),c=[];for(n in t)("constructor"!=n||!a&&At.call(t,n))&&c.push(n);return c}function Ft(t){return ut(t)?jt(t,!0):Ot(t)}var j=f(Object,"create");var Mt=Object.prototype.hasOwnProperty;var St=Object.prototype.hasOwnProperty;function _(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function g(t,e){for(var r=t.length;r--;)if(ot(t[r][0],e))return r;return-1}_.prototype.clear=function(){this.__data__=j?j(null):{},this.size=0},_.prototype.delete=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},_.prototype.get=function(t){var e,r=this.__data__;return j?"__lodash_hash_undefined__"===(e=r[t])?void 0:e:Mt.call(r,t)?r[t]:void 0},_.prototype.has=function(t){var e=this.__data__;return j?void 0!==e[t]:St.call(e,t)},_.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=j&&void 0===e?"__lodash_hash_undefined__":e,this};var xt=Array.prototype.splice;function m(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}m.prototype.clear=function(){this.__data__=[],this.size=0},m.prototype.delete=function(t){var e=this.__data__;return!((t=g(e,t))<0||(t==e.length-1?e.pop():xt.call(e,t,1),--this.size,0))},m.prototype.get=function(t){var e=this.__data__;return(t=g(e,t))<0?void 0:e[t][1]},m.prototype.has=function(t){return-1<g(this.__data__,t)},m.prototype.set=function(t,e){var r=this.__data__,o=g(r,t);return o<0?(++this.size,r.push([t,e])):r[o][1]=e,this};var w=f(r,"Map");function A(t,e){var r,o,t=t.__data__;return("string"==(o=typeof(r=e))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==r:null===r)?t["string"==typeof e?"string":"hash"]:t.map}function O(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function zt(t,e){for(var r=-1,o=e.length,n=t.length;++r<o;)t[n+r]=e[r];return t}O.prototype.clear=function(){this.size=0,this.__data__={hash:new _,map:new(w||m),string:new _}},O.prototype.delete=function(t){return t=A(this,t).delete(t),this.size-=t?1:0,t},O.prototype.get=function(t){return A(this,t).get(t)},O.prototype.has=function(t){return A(this,t).has(t)},O.prototype.set=function(t,e){var r=A(this,t),o=r.size;return r.set(t,e),this.size+=r.size==o?0:1,this};var Ct=_t(Object.getPrototypeOf,Object);function E(t){t=this.__data__=new m(t);this.size=t.size}E.prototype.clear=function(){this.__data__=new m,this.size=0},E.prototype.delete=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t},E.prototype.get=function(t){return this.__data__.get(t)},E.prototype.has=function(t){return this.__data__.has(t)},E.prototype.set=function(t,e){var r=this.__data__;if(r instanceof m){var o=r.__data__;if(!w||o.length<199)return o.push([t,e]),this.size=++r.size,this;r=this.__data__=new O(o)}return r.set(t,e),this.size=r.size,this};var e="object"==typeof t&&t&&!t.nodeType&&t,p=e&&"object"==typeof module&&module&&!module.nodeType&&module,p=p&&p.exports===e?r.Buffer:void 0,Et=p?p.allocUnsafe:void 0;function Pt(){return[]}var kt=Object.prototype.propertyIsEnumerable,Dt=Object.getOwnPropertySymbols,Lt=Dt?function(e){if(null==e)return[];e=Object(e);for(var t=Dt(e),r=function(t){return kt.call(e,t)},o=-1,n=null==t?0:t.length,a=0,c=[];++o<n;){var i=t[o];r(i,o,t)&&(c[a++]=i)}return c}:Pt;var Bt=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)zt(e,Lt(t)),t=Ct(t);return e}:Pt;function It(t,e,r){e=e(t);return S(t)?e:zt(e,r(t))}function Ut(t){return It(t,wt,Lt)}function Rt(t){return It(t,Ft,Bt)}var e=f(r,"DataView"),p=f(r,"Promise"),F=f(r,"Set"),Tt="[object Map]",qt="[object Promise]",Gt="[object Set]",$t="[object WeakMap]",Nt="[object DataView]",Vt=l(e),Wt=l(w),Ht=l(p),Jt=l(F),Kt=l(n),M=a,Qt=M=e&&M(new e(new ArrayBuffer(1)))!=Nt||w&&M(new w)!=Tt||p&&M(p.resolve())!=qt||F&&M(new F)!=Gt||n&&M(new n)!=$t?function(t){var e=a(t),t="[object Object]"==e?t.constructor:void 0,t=t?l(t):"";if(t)switch(t){case Vt:return Nt;case Wt:return Tt;case Ht:return qt;case Jt:return Gt;case Kt:return $t}return e}:M,Xt=Object.prototype.hasOwnProperty;var Yt=r.Uint8Array;function Zt(t){var e=new t.constructor(t.byteLength);return new Yt(e).set(new Yt(t)),e}var te=/\w*$/;var e=o?o.prototype:void 0,ee=e?e.valueOf:void 0;function re(t,e,r){var o,n,a,c,i=t.constructor;switch(e){case"[object ArrayBuffer]":return Zt(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return a=t,c=(c=r)?Zt(a.buffer):a.buffer,new a.constructor(c,a.byteOffset,a.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return c=t,a=(a=r)?Zt(c.buffer):c.buffer,new c.constructor(a,c.byteOffset,c.length);case"[object Map]":return new i;case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return(n=new(o=t).constructor(o.source,te.exec(o))).lastIndex=o.lastIndex,n;case"[object Set]":return new i;case"[object Symbol]":return o=t,ee?Object(ee.call(o)):{}}}var p=b&&b.isMap,oe=p?d(p):function(t){return u(t)&&"[object Map]"==Qt(t)};var F=b&&b.isSet,ne=F?d(F):function(t){return u(t)&&"[object Set]"==Qt(t)},ae="[object Arguments]",ce="[object Function]",ie="[object Object]",P={};function k(r,o,n,t,e,a){var c,i=1&o,u=2&o,l=4&o;if(void 0===(c=n?e?n(r,t,e,a):n(r):c)){if(!x(r))return r;var s,p,f,y,b,t=S(r);if(t){if(_=(g=r).length,b=new g.constructor(_),_&&"string"==typeof g[0]&&Xt.call(g,"index")&&(b.index=g.index,b.input=g.input),c=b,!i){var h=r,d=c,v=-1,j=h.length;for(d=d||Array(j);++v<j;)d[v]=h[v];return d}}else{var _=Qt(r),g=_==ce||"[object GeneratorFunction]"==_;if(bt(r))return b=r,(y=i)?b.slice():(y=b.length,y=Et?Et(y):new b.constructor(y),b.copy(y),y);if(_==ie||_==ae||g&&!e){if(c=u||g||"function"!=typeof(y=r).constructor||C(y)?{}:Z(Ct(y)),!i)return u?(f=s=r,f=(p=c)&&z(f,Ft(f),p),z(s,Bt(s),f)):(s=p=r,m=(f=c)&&z(s,wt(s),f),z(p,Lt(p),m))}else{if(!P[_])return e?r:{};c=re(r,_,i)}}var m=(a=a||new E).get(r);if(m)return m;a.set(r,c),ne(r)?r.forEach(function(t){c.add(k(t,o,n,t,r,a))}):oe(r)&&r.forEach(function(t,e){c.set(e,k(t,o,n,e,r,a))});for(var w=t?void 0:(l?u?Rt:Ut:u?Ft:wt)(r),A=w||r,O=function(t,e){w&&(t=r[e=t]),at(c,e,k(t,o,n,e,r,a))},F=-1,M=null==A?0:A.length;++F<M&&!1!==O(A[F],F,A););}return c}P[ae]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object DataView]"]=P["[object Boolean]"]=P["[object Date]"]=P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Map]"]=P["[object Number]"]=P[ie]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object Symbol]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P["[object Error]"]=P[ce]=P["[object WeakMap]"]=!1;function ue(t){return k(t,5)}var D=3.141592653589793,le=.006693421622965943;function se(t,e){var r,o,n,a,c;return c=e,(a=t)<72.004||137.8347<a||c<.8293||55.8271<c?[t,e]:(r=2*(a=t-105)-100+3*(c=e-35)+.2*c*c+.1*a*c+.2*Math.sqrt(Math.abs(a)),a=(r+=2*(20*Math.sin(6*a*D)+20*Math.sin(2*a*D))/3)+2*(20*Math.sin(c*D)+40*Math.sin(c/3*D))/3+2*(160*Math.sin(c/12*D)+320*Math.sin(c*D/30))/3,c=300+(r=t-105)+2*(c=e-35)+.1*r*r+.1*r*c+.1*Math.sqrt(Math.abs(r)),c=(c+=2*(20*Math.sin(6*r*D)+20*Math.sin(2*r*D))/3)+2*(20*Math.sin(r*D)+40*Math.sin(r/3*D))/3+2*(150*Math.sin(r/12*D)+300*Math.sin(r/30*D))/3,r=e/180*D,o=Math.sin(r),o=1-le*o*o,n=Math.sqrt(o),a=180*a/(6378245*(1-le)/(o*n)*D),[2*t-(t+(c=180*c/(6378245/n*Math.cos(r)*D))),2*e-(e+a)])}function pe(t,e){t=t,e=e,r=52.35987755982988,t-=.0065,e-=.006,o=Math.sqrt(t*t+e*e)-2e-5*Math.sin(e*r),e=Math.atan2(e,t)-3e-6*Math.cos(t*r);var r,o,t=[o*Math.cos(e),o*Math.sin(e)];return se(t[0],t[1])}function fe(t,e){return{type:"geojson",data:function(t,e){if(e===void 0)e=true;var r=e?de(t):t;return ve(ye(r))}(t,e=void 0===e?!0:e),cluster:!1}}var ye=function(t){return null==t?void 0:t.map(function(t,e){var r=t.level||t.vul_level||t.risk_category||t.ransom_type||t.malicious_name||t.gps_type||"机构",o=ue(t.realGps),n=ue(t.gps),a="机构"===r?pe(n[0],n[1]):s([],n,!0),o={realLngGps:(o||a)[0],realLatGps:(o||a)[1]};return{type:"Feature",properties:c({data:t.data,count:t.count||0,lng:a[0],lat:a[1],queryLng:n[0],queryLat:n[1],level:r,point_type:t.point_type,keyStr:r},o),geometry:{type:"Point",coordinates:s([],a,!0)}}})};function be(t,e,r){for(var o=String(t),n=0;n<e;n++)o="".concat(o).concat(r||0===r?r:Math.floor(9*Math.random()+1));return o}function he(t,e){var t=String(t),r=t.split(".")[0],o=t.split(".")[1];return o?(o=be(o,6-o.length,0),o=be(o,e),parseFloat("".concat(r,".").concat(o))):Number(t)}var de=function(t){return t.map(function(t){var e=t.gps,r=e[0],e=e[1],r=he(r,3),e=he(e,3);return c(c({},t),{realGps:t.gps,gps:[r,e]})})},ve=function(t){return{type:"FeatureCollection",features:t=void 0===t?[]:t}},je=["blue","#00CFFF","lightBlue","#28A4FF","服务协议层","#00CE5A","操作系统层","#F6A109","硬件设备层","#F6A109","终端","#F1AC00","apt","#FFA35C","超危","#E00F20","高危","#F84D04","中危","#F19900","低危","#E7CE00","资产异常","#E44806","配置错误","#FFD600","确定受影响资产","#E44806","疑似受影响资产","#FFD600","违法网址","#E44806","欺诈网址","#FFD600","高","#F84D04","中","#F19900","低","#E7CE00","低风险机构","#C9AF47","中风险机构","#F84404","高风险机构","#D10314","安全","#27FFA9","风险","#FFA35C","可疑","#FFD600"],_e=["blue","#0060E9","lightBlue","#006AB0","green","#00856E","orange","#A77D00","yellow","#A97001","deepRed","#931721","red","#F84D04"],ge=["blue","#14E6FF","lightBlue","#28A4FF","green","#00CE5A","orange","#F6A109","yellow","#FFD600","deepRed","#E00F20","red","#E64500"];function L(t,e){this.map={},this.options={},this.map=t}L.prototype.addCommonLayer=function(t,e,r){var r=r||this.options,o=r.mapColorList,n=r.circleBlur,a=r.circleColor,c=r.circleOpacity,i=r.circleRadius,u=r.dotSize,l=r.circleStrokeWidth,r=r.circleStrokeColor;this.map.addSource(e,fe(t)),this.map.addLayer({id:e,type:"circle",source:e,paint:{"circle-blur":null!=(t=n)?t:0,"circle-color":null!=(e=a)?e:s(s(["match",["get","keyStr"]],o||je,!0),["rgba(237,97,147,0.9)"],!1),"circle-color-transition":{duration:2},"circle-opacity":c,"circle-radius":null!=(n=i)?n:s(["interpolate",["exponential",.1],["zoom"]],u||[14.1,3,32,9],!0),"circle-stroke-width":null!=(t=l)?t:0,"circle-stroke-color":null!=(a=r)?a:"#ffffff"}})},L.prototype.addGlowwormLayer=function(t,e,r){var o=e.glowwormLayerName,n=e.glowwormInnerColorList,e=e.glowwormOutColorList;this.addCommonLayer(t,o||"glowworm",{circleOpacity:.4,circleBlur:3,circleColor:s(s(["match",["get","keyStr"]],e||_e,!0),["rgba(237,97,147,0.9)"],!1),circleRadius:["interpolate",["exponential",.1],["zoom"],14.1,14,32,22]}),this.addCommonLayer(t,"glowworm2",{circleOpacity:.4,circleBlur:3,circleColor:s(s(["match",["get","keyStr"]],n||ge,!0),["rgba(237,97,147,0.9)"],!1),circleRadius:["interpolate",["exponential",.1],["zoom"],14.1,9,32,12]}),this.addCommonLayer(t,"glowworm3",{circleOpacity:1,circleBlur:0,circleColor:"#ffffff",circleRadius:["interpolate",["exponential",.1],["zoom"],14.1,1.3,32,2.2]})},L.prototype.addSimpleCityLayer=function(){this.map.addLayer({id:"simple-cities",type:"symbol",source:"simpleCity",minzoom:5,maxzoom:12,layout:{"text-field":"{title}","text-font":["DIN Pro Medium","Arial Unicode MS Regular"],"text-size":["interpolate",["cubic-bezier",.2,0,.9,1],["zoom"],2,["step",["get","symbolrank"],3,3,3],6,["step",["get","symbolrank"],23.400000000000002,6,20.8,7,18.2],8,["step",["get","symbolrank"],10,9,10,10,18.2],15,["step",["get","symbolrank"],31.200000000000003,9,26,12,20.8,15,18.2]]},paint:{"text-color":"hsl(215, 28%, 71%)","text-halo-color":"hsla(215, 91%, 48%, 0.24)","text-halo-width":1,"icon-opacity":.63,"text-halo-blur":1}})},t.GlowwormMap=L});
